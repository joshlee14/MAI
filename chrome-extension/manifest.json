{
  "manifest_version": 3,
  "name": "Project Icarus",
  "description": "Medicare Advantage plan comparison and AI closing assistant",
  "version": "1.2.1",
  "action": {
    // Clicking the toolbar icon now toggles the MAI Copilot HUD instead of opening a popup.
    "default_title": "MAI Copilot"
  },
  // Request storage for HUD persistence and the tab permissions so the background
  // service worker can send a message to the active tab when the user clicks the
  // toolbar button.
  "permissions": [
    "storage",
    "tabs",
    "activeTab"
  ],

  // Define a background service worker.  This script will listen for the
  // action (toolbar icon) click and dispatch a message to the current tab
  // instructing the content script to toggle the HUD.
  "background": {
    "service_worker": "background.js",
    "type": "module"
  },
  // Inject the MAI HUD on all Sunfire pages.  The content script runs at the end
  // of document loading and in all frames so that the overlay appears even when
  // Sunfire embeds content in iframes.
  "content_scripts": [
    {
      "matches": [
        "https://*.sunfirematrix.com/*",
        "https://sunfirematrix.com/*"
      ],
      "js": ["contentScript.js"],
      "css": ["hud.css"],
      "run_at": "document_end",
      "all_frames": true
    }
  ],
  // Make icons and the HUD stylesheet available to the Shadow DOM via
  // chrome.runtime.getURL().  Without declaring these resources here, the
  // content script cannot load them inside the isolated shadow root.
  "web_accessible_resources": [
    {
      "resources": [
        "icons/icon16.png",
        "icons/icon48.png",
        "icons/icon128.png",
        "hud.css"
      ],
      "matches": ["<all_urls>"]
    }
  ],
  // Host permissions for the domains where the content script will run.  We
  // include localhost for development (to allow fetches to the backend) and
  // the Sunfire domains for injecting the HUD.  Additional domains can be
  // added here if the overlay should run elsewhere.
  "host_permissions": [
    "http://localhost:3000/*",
    "https://*.sunfirematrix.com/*",
    "https://sunfirematrix.com/*"
  ],
  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  }
}